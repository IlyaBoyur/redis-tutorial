# Шпоргалка Redis


## Подключение
```bash
# Поднять контейнер с базой Redis в текущей папке
$ docker compose up -d --remove-orphans
$ docker compose exec -it redis sh
/data # redis-cli
127.0.0.1:6379> PING
PONG
```


## Базовые команды
`SET <key> <value>` - добавить значение по ключу  
`GET <key>` - получить значение по ключу  
`INCR <key>` - увеличить на 1 значение по ключу  
`INCRBY <key> <increment>` - увеличить на N значение по ключу    
`DECR <key>` - уменьшить на 1 значение по ключу  
`DECRBY <key> <increment>` - уменьшить на N значение по ключу  
`MSET` - добавить значения по нескольким ключам  
`MGET` - получить значения по нескольким ключам  


### Транзакция
`MULTI` - старт транзакции  
Ввод команд: `SET, GET, INCR, DECR...`  
`EXEC` - выполнить введенные команды по очереди  
(`DISCARD` - отменить транзакцию)  


## Составные типы данных


### Хеш
Хеши играют в Redis роль объектов-контейнеров, способных хра-
нить произвольное число пар ключ-значение.

`HMSET <key> <field> <value> [<field> <value> ...]`  
`HVALS <key>`  
`HKEYS <key>`  
`HGET <key> <field>`  
`HDEL <key> <field> [<field> ...]`  
`HINCRBY <key> <field> <increment>`  
`HLEN <key>`  


### Список
`RPUSH <key> <element>` - вставить элемент справа  
`LLEN <key>` - длина списка  
`LRANGE <key> <start> <stop>` - срез списка. "0" - первый элемент, "-1" - последний элемент  
`LREM <key> <count> <element>` - удалить из списка с заданным ключом указанные значения. Необходимо передать число, сообщающее, сколько элементов с указанным значением удалять. Если этот параметр равен 0, то удаляются все подходящие значения  
`LPOP key [count]` - удалить и вернуть значение (как в очереди, если добавляли через `RPUSH`)  
`RPOP key [count]` - удалить и вернуть значение (как в стеке, если добавляли через `RPUSH`)  
`RPOPLPUSH <source> <destination>` - атомарно удалить из одного списка и добавить в другой


### Блокирующие списки
Redis предлагает несколько блокирующих команд:
`BRPOP <key> [<key> ...] <timeout>` - блокировать консоль и ожидать новое сообщение.  
(Также доступны: `BLPOP`, `BRPOPLPUSH`)

В другой консоли (клиенте):  
`LPUSH <key>` - добавить в список новый элемент  


### Множество
Множеством называется неупорядоченная коллекция без дубликатов.  
Они отлично подходят для выполнения таких операций над
значениями двух и более ключей, как объединение и пересечение.  

`SADD <key> <member> [<member> ...]` - добавить элементы в множество  
`SMEMBERS <key>` - вывести элементы множества  
`SINTER <key> [<key> ...]` - вывести пересечение множеств  
`SDIFF <key> [<key> ...]` - вывести разность множеств  
`SUNION <key> [<key> ...]` - вывести объединение множеств  
`SUNIONSTORE <destionation> <key> [<key> ...]` - сохранить объединение множеств  
(аналогично сохранить результатов пересечения (`SINTERSTORE`) и разности (`SDIFFSTORE`))  
`SMOVE <source> <destionation> <member>` - переместить элемент из одного множества в другое  
`SCARD` - вывести число элементов в множестве  

`SPOP key` - извлечь случайный элемент  
`SREM key value [value ...]` - удалить элемент  


## Отсортированные множества
`ZADD <key> <score> <member>  [<score> <member> ...] ` - добавить элементы в отсортированное множество. Позиция в множестве определяется номером (score)  
`ZINCRBY <key> <increment> <member>` - увеличить/уменьшить позицию на указанную величину  



